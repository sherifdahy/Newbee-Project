<!-- ====================== ๐ข Company Tabs Layout ====================== -->
<ul class="nav nav-tabs" id="companyTabs" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active fw-semibold" id="general-information-tab" data-bs-toggle="tab"
      data-bs-target="#general-information" type="button" role="tab" aria-controls="general-information"
      aria-selected="true">
      <i class="fa-solid fa-circle-info me-1"></i> ุจูุงูุงุช ุฃุณุงุณูุฉ
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link fw-semibold" id="branches-tab" data-bs-toggle="tab" data-bs-target="#branches" type="button"
      role="tab" aria-controls="branches" aria-selected="false">
      <i class="fa-solid fa-code-branch me-1"></i> ุงููุฑูุน
    </button>
  </li>
</ul>

<div class="tab-content border border-top-0 rounded-bottom shadow-sm bg-light-subtle p-3" id="companyTabsContent">

  <!-- ๐จโ๐ผ ุจูุงูุงุช ุฃุณุงุณูุฉ -->
  <div class="tab-pane fade show active" id="general-information" role="tabpanel"
    aria-labelledby="general-information-tab">
    <form [formGroup]="_companyForm">

      <!-- ๐ธ Basic Info -->
      <div class="row g-4">
        <!-- ุงุณู ุงูุดุฑูุฉ -->
        <div class="col-md-6">
          <label class="form-label fw-semibold text-secondary">ุงุณู ุงูุดุฑูุฉ <span class="text-danger">*</span></label>
          <input (blur)="updateCompany()" formControlName="name" type="text" class="form-control form-control-md"
            placeholder="ุงุฏุฎู ุงุณู ุงูุดุฑูุฉ"
            [class.is-invalid]="_companyForm.get('name')?.invalid && _companyForm.get('name')?.touched" />
          <div class="invalid-feedback">ูุฌุจ ุฅุฏุฎุงู ุงุณู ุงูุดุฑูุฉ</div>
        </div>

        <!-- ุฑูู ุงูุชุณุฌูู ุงูุถุฑูุจู -->
        <div class="col-md-6">
          <label class="form-label fw-semibold text-secondary">ุฑูู ุงูุชุณุฌูู ุงูุถุฑูุจู <span
              class="text-danger">*</span></label>
          <input (blur)="updateCompany()" formControlName="rin" type="text" class="form-control form-control-md"
            placeholder="ุงุฏุฎู ุฑูู ุงูุชุณุฌูู ุงูุถุฑูุจู"
            [class.is-invalid]="_companyForm.get('rin')?.invalid && _companyForm.get('rin')?.touched" />
          <div class="invalid-feedback">ุฑูู ุงูุชุณุฌูู ุงูุถุฑูุจู ูุทููุจ</div>
        </div>
      </div>

      <!-- ====================== ๐ Inner Tabs (Managers / Codes) ====================== -->
      <ul class="nav nav-tabs mt-5" id="companyInnerTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active fw-semibold" id="managers-tab" data-bs-toggle="tab" data-bs-target="#managers"
            type="button" role="tab">
            <i class="fa-solid fa-user-tie me-1"></i> ุงููุฏูุฑูู
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link fw-semibold" id="codes-tab" data-bs-toggle="tab" data-bs-target="#codes" type="button"
            role="tab">
            <i class="fa-solid fa-barcode me-1"></i> ุฃููุงุฏ ุงููุดุงุท
          </button>
        </li>
      </ul>

      <div class="tab-content border border-top-0 rounded-bottom shadow-sm bg-light-subtle p-3"
        id="companyInnerTabsContent">

        <!-- ๐จโ๐ผ ุงููุฏูุฑูู -->
        <div class="tab-pane fade show active" id="managers" role="tabpanel" aria-labelledby="managers-tab">
          <div class="text-start mb-3">
            <button type="button" (click)="openManagerDialog(0)" class="btn btn-outline-primary btn-sm">
              <i class="fa-solid fa-plus me-1"></i> ุฅุถุงูุฉ ูุฏูุฑ ุฌุฏูุฏ
            </button>
          </div>
          <app-managers-grid (openManagerDialogListner)="openManagerDialog($event)"
            [companyId]="_companyId"></app-managers-grid>
        </div>

        <!-- ๐ข ุฃููุงุฏ ุงููุดุงุท -->
        <div class="tab-pane fade" id="codes" role="tabpanel" aria-labelledby="codes-tab">
          <div class="text-start mb-3">
            <button type="button" class="btn btn-outline-primary btn-sm" (click)="addCode()">
              <i class="fa-solid fa-plus me-1"></i> ุฅุถุงูุฉ ููุฏ ุฌุฏูุฏ
            </button>
          </div>

          <div class="table-responsive border overflow-hidden bg-white rounded-3">
            <table class="table table-hover align-middle mb-0 text-center">
              <thead class="table-primary">
                <tr>
                  <th class="col-1">#</th>
                  <th class="col-10">ููุฏ ุงููุดุงุท</th>
                  <th class="col-1"></th>
                </tr>
              </thead>
              <tbody>
                <!-- <tr *ngFor="let codeCtrl of activeCodes.controls; let i = index">
                  <td class="fw-semibold">{{ i + 1 }}</td>
                  <td>
                    <select class="form-select form-select-sm text-center" [formControlName]="i"
                      [class.is-invalid]="codeCtrl.invalid && codeCtrl.touched">
                      <option value="" disabled>ุงุฎุชุฑ ููุฏ ุงููุดุงุท</option>
                      <option *ngFor="let code of _activeCodes" [value]="code.id">{{ code.code }}</option>
                    </select>
                  </td>
                  <td>
                    <button type="button" class="btn btn-outline-danger btn-sm" (click)="removeCode(i)">
                      <i class="fa-solid fa-trash"></i>
                    </button>
                  </td>
                </tr>
                <tr *ngIf="activeCodes.length === 0">
                  <td colspan="3" class="text-center text-muted py-3">ูุง ุชูุฌุฏ ุฃููุงุฏ ูุถุงูุฉ ุจุนุฏ</td>
                </tr> -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </form>
  </div>

  <!-- ====================== ๐ฌ ุงููุฑูุน ====================== -->
  <div class="tab-pane fade" id="branches" role="tabpanel" aria-labelledby="branches-tab">
    <!-- Branch Selection & Add Button -->
    <div class="d-flex justify-content-between align-items-start mb-4">
      <div class="form-group w-50">
        <label class="form-label fw-semibold text-secondary">ุงุฎุชุฑ ูุฑุน <span class="text-danger">*</span></label>
        <select [(ngModel)]="selectedBranchId" class="form-select form-select-md">
          <option value="" disabled selected>ุงุฎุชุฑ ุงููุฑุน</option>
          <option *ngFor="let branch of _branches" [value]="branch.id">{{branch.code}}</option>
        </select>
      </div>
      <button type="button" class="btn btn-outline-primary btn-sm" (click)="openBranchDialog(0)">
        <i class="fa-solid fa-plus me-1"></i>
        ุฅุถุงูุฉ ูุฑุน ุฌุฏูุฏ
      </button>
    </div>

    <!-- ๐งฉ Tabs -->
    <ng-container *ngIf="selectedBranchId">
      <ul class="nav nav-tabs mt-5" id="branchTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="employees-tab" data-bs-toggle="tab" data-bs-target="#employees"
            type="button" role="tab">
            <i class="fa-solid fa-users me-1"></i> ุงูููุธููู
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="pos-tab" data-bs-toggle="tab" data-bs-target="#pos" type="button" role="tab">
            <i class="fa-solid fa-store me-1"></i> ููุงุท ุงูุจูุน
          </button>
        </li>
      </ul>

      <div class="tab-content border border-top-0 rounded-bottom shadow-sm bg-light-subtle p-3" id="branchTabsContent">

        <!-- ๐จโ๐ผ ุงูููุธููู -->
        <div class="tab-pane fade show active" id="employees" role="tabpanel" aria-labelledby="employees-tab">
          <div class="text-start mb-3">
            <button type="button" (click)="openEmployeeDialog(0)" class="btn btn-outline-primary btn-sm">
              <i class="fa-solid fa-plus me-1"></i> ุฅุถุงูุฉ ููุธู
            </button>
          </div>

          <app-employee-grid [branchId]="selectedBranchId"></app-employee-grid>
        </div>

        <!-- ๐ณ ููุงุท ุงูุจูุน -->
        <div class="tab-pane fade" id="pos" role="tabpanel" aria-labelledby="pos-tab">
          <div class="text-start mb-3">
            <button type="button" (click)="openPointOfSaleDialog(0)" class="btn btn-outline-primary btn-sm">
              <i class="fa-solid fa-plus me-1"></i> ุฅุถุงูุฉ ููุทุฉ ุจูุน
            </button>
          </div>

          <app-point-of-sale-grid (openPointOfSaleDialogListner)="openPointOfSaleDialog($event)"
            [branchId]="selectedBranchId"></app-point-of-sale-grid>
        </div>

      </div>
    </ng-container>

  </div>
</div>
